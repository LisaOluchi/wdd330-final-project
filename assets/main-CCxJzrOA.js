import{s as c}from"./toast-pCh7I1Sp.js";const L=[{id:"happy",emoji:"üòä",label:"Happy",desc:"Joyful & bright",color:"#f5c842",quoteTag:"happiness",musicQuery:"happy upbeat pop"},{id:"calm",emoji:"üåø",label:"Calm",desc:"Peaceful & still",color:"#6db58e",quoteTag:"peace",musicQuery:"chill lofi ambient"},{id:"sad",emoji:"üåßÔ∏è",label:"Sad",desc:"Heavy & tender",color:"#7da8d4",quoteTag:"inspirational",musicQuery:"sad emotional ballad"},{id:"anxious",emoji:"üåÄ",label:"Anxious",desc:"Unsettled & tense",color:"#c4775a",quoteTag:"courage",musicQuery:"calming meditation relaxing"},{id:"motivated",emoji:"üî•",label:"Motivated",desc:"Driven & focused",color:"#e07b39",quoteTag:"motivational",musicQuery:"motivational workout energy"},{id:"nostalgic",emoji:"üçÇ",label:"Nostalgic",desc:"Reflective & warm",color:"#c49a5a",quoteTag:"life",musicQuery:"nostalgic retro indie folk"},{id:"tired",emoji:"üåô",label:"Tired",desc:"Weary & soft",color:"#9b8ac4",quoteTag:"rest",musicQuery:"sleep relaxing acoustic soft"},{id:"grateful",emoji:"üå∏",label:"Grateful",desc:"Thankful & open",color:"#d47ba3",quoteTag:"gratitude",musicQuery:"grateful acoustic soulful"}];function B(e,t){e.innerHTML="",L.forEach(o=>{const n=document.createElement("button");n.className="mood-card",n.setAttribute("data-mood-id",o.id),n.setAttribute("aria-label",`Select mood: ${o.label}`),n.style.setProperty("--mood-color",o.color),n.innerHTML=`
      <span class="mood-emoji" aria-hidden="true">${o.emoji}</span>
      <span class="mood-label">${o.label}</span>
      <span class="mood-desc">${o.desc}</span>
    `,n.addEventListener("click",()=>{t(o)}),e.appendChild(n)})}const I="https://api.api-ninjas.com/v1/quotes",T="qhNv8RLHdTus0JacHqRGPg==vGXhuJGrnE5Vbo8s",h={happiness:[{content:"Happiness is not something ready-made. It comes from your own actions.",author:"Dalai Lama"},{content:"The most important thing is to enjoy your life‚Äîto be happy‚Äîit's all that matters.",author:"Audrey Hepburn"}],peace:[{content:"Do not let the behavior of others destroy your inner peace.",author:"Dalai Lama"},{content:"Peace comes from within. Do not seek it without.",author:"Buddha"}],inspirational:[{content:"Even the darkest night will end and the sun will rise.",author:"Victor Hugo"},{content:"Believe you can and you're halfway there.",author:"Theodore Roosevelt"}],courage:[{content:"Breathe. It's just a bad day, not a bad life.",author:"Unknown"},{content:"You are braver than you believe, stronger than you seem, and smarter than you think.",author:"A.A. Milne"}],motivational:[{content:"The secret of getting ahead is getting started.",author:"Mark Twain"},{content:"Don't watch the clock; do what it does. Keep going.",author:"Sam Levenson"}],life:[{content:"In the end, it's not the years in your life that count. It's the life in your years.",author:"Abraham Lincoln"},{content:"Life is what happens when you're busy making other plans.",author:"John Lennon"}],rest:[{content:"Almost everything will work again if you unplug it for a few minutes, including you.",author:"Anne Lamott"},{content:"Rest when you're weary. Refresh and renew yourself.",author:"Ralph Marston"}],gratitude:[{content:"Gratitude turns what we have into enough.",author:"Melody Beattie"},{content:"Enjoy the little things, for one day you may look back and realize they were the big things.",author:"Robert Brault"}]};async function k(e){try{const t=await fetch(`${I}?category=${e}`,{headers:{"X-Api-Key":T},signal:AbortSignal.timeout(5e3)});if(!t.ok)throw new Error(`HTTP ${t.status}`);const o=await t.json();if(o&&o[0])return{content:o[0].quote,author:o[0].author};throw new Error("No quote returned")}catch(t){console.warn("Quotes API failed, using fallback:",t.message);const o=h[e]??h.inspirational;return o[Math.floor(Math.random()*o.length)]}}const S="https://itunes.apple.com/search",q=[{id:1,title:"Weightless",artist:"Marconi Union",album:"Weightless",cover:"",preview:"",duration:479},{id:2,title:"Clair de Lune",artist:"Claude Debussy",album:"Piano Works",cover:"",preview:"",duration:302},{id:3,title:"River Flows in You",artist:"Yiruma",album:"First Love",cover:"",preview:"",duration:214},{id:4,title:"Sunset Lover",artist:"Petit Biscuit",album:"Petit Biscuit",cover:"",preview:"",duration:213},{id:5,title:"Bloom",artist:"ODESZA",album:"Summer's Gone",cover:"",preview:"",duration:261}];async function A(e){var t;try{const o=`${S}?term=${encodeURIComponent(e)}&media=music&entity=song&limit=5`,n=await fetch(o,{signal:AbortSignal.timeout(8e3)});if(!n.ok)throw new Error(`HTTP ${n.status}`);const l=await n.json();if(!((t=l.results)!=null&&t.length))throw new Error("No tracks returned");return l.results.slice(0,5).map(a=>({id:a.trackId,title:a.trackName,artist:a.artistName,album:a.collectionName||"",cover:a.artworkUrl100||"",preview:a.previewUrl||"",duration:Math.floor((a.trackTimeMillis||0)/1e3)}))}catch(o){return console.warn("Music API unavailable, using fallback:",o.message),q}}function M(e){return e?`${Math.floor(e/60)}:${String(e%60).padStart(2,"0")}`:""}const v="moodwave_favorites";function d(){try{return JSON.parse(localStorage.getItem(v))||[]}catch{return[]}}function p(e){const t=d();return t.some(n=>n.type===e.type&&JSON.stringify(n.data)===JSON.stringify(e.data))?!1:(t.unshift({...e,savedAt:Date.now()}),localStorage.setItem(v,JSON.stringify(t)),!0)}function $(e){const t=d();t.splice(e,1),localStorage.setItem(v,JSON.stringify(t))}function C(){return d().length}function y(e){document.querySelectorAll(".screen").forEach(o=>o.classList.remove("active"));const t=document.getElementById(e);t&&(t.classList.add("active"),window.scrollTo({top:0,behavior:"smooth"}))}function Q(e){const t=document.getElementById("moodBadge");t&&(t.innerHTML=`<span aria-hidden="true">${e.emoji}</span> ${e.label}`,t.style.background=`${e.color}22`,t.style.color=e.color)}function x(){document.getElementById("quoteLoading").style.display="flex",document.getElementById("quoteContent").hidden=!0,document.getElementById("quoteError").hidden=!0}function H(e){document.getElementById("quoteLoading").style.display="none",document.getElementById("quoteError").hidden=!0,document.getElementById("quoteText").textContent=e.content,document.getElementById("quoteAuthor").textContent=e.author;const t=document.getElementById("saveQuoteBtn");t.textContent="‚ô• Save",t.classList.remove("saved"),t.onclick=()=>{p({type:"quote",data:e})?(t.textContent="‚ô• Saved!",t.classList.add("saved"),u(),c("Quote saved to favorites ‚ô•")):c("Already in your favorites!")},document.getElementById("quoteContent").hidden=!1}function j(){document.getElementById("quoteLoading").style.display="none",document.getElementById("quoteContent").hidden=!0,document.getElementById("quoteError").hidden=!1}let i=null;function N(){document.getElementById("musicLoading").style.display="flex",document.getElementById("tracksList").hidden=!0,document.getElementById("musicError").hidden=!0}function P(e){document.getElementById("musicLoading").style.display="none",document.getElementById("musicError").hidden=!0;const t=document.getElementById("tracksList");if(t.innerHTML="",!(e!=null&&e.length)){t.innerHTML='<p class="loading-state">No tracks found for this mood.</p>',t.hidden=!1;return}e.forEach(o=>{const n=document.createElement("div");n.className="track-item";const l=o.cover?`<img class="track-cover" src="${o.cover}" alt="${r(o.title)} cover" loading="lazy">`:'<div class="track-cover-placeholder" aria-hidden="true">‚ô™</div>';n.innerHTML=`
      ${l}
      <div class="track-info">
        <div class="track-title">${r(o.title)}</div>
        <div class="track-artist">${r(o.artist)}${o.album?" ¬∑ "+r(o.album):""}${o.duration?" ¬∑ "+M(o.duration):""}</div>
      </div>
      <div class="track-actions">
        ${o.preview?`<button class="btn-play" aria-label="Play preview of ${r(o.title)}" title="Play 30s preview">‚ñ∂</button>`:""}
        <button class="btn-track-save" aria-label="Save ${r(o.title)}" title="Save to favorites">‚ô•</button>
      </div>
    `,o.preview&&n.querySelector(".btn-play").addEventListener("click",a=>D(o,a.currentTarget)),n.querySelector(".btn-track-save").addEventListener("click",a=>{p({type:"track",data:o})?(a.currentTarget.style.color="var(--accent)",u(),c(`"${o.title}" saved ‚ô•`)):c("Already in your favorites!")}),t.appendChild(n)}),t.hidden=!1}function D(e,t){i&&i.src!==e.preview&&(i.pause(),document.querySelectorAll(".btn-play").forEach(o=>o.textContent="‚ñ∂")),(!i||i.src!==e.preview)&&(i=new Audio(e.preview),i.addEventListener("ended",()=>t.textContent="‚ñ∂")),i.paused?(i.play().catch(()=>c("Could not play preview")),t.textContent="‚è∏"):(i.pause(),t.textContent="‚ñ∂")}function b(){i&&(i.pause(),i=null,document.querySelectorAll(".btn-play").forEach(e=>e.textContent="‚ñ∂"))}function F(){document.getElementById("musicLoading").style.display="none",document.getElementById("tracksList").hidden=!0,document.getElementById("musicError").hidden=!1}function E(){const e=document.getElementById("favoritesList"),t=document.getElementById("emptyFavorites"),o=d();if(e.innerHTML="",!o.length){t.hidden=!1;return}t.hidden=!0,o.forEach((n,l)=>{const a=document.createElement("div");a.className="fav-item",n.type==="quote"?a.innerHTML=`
        <div>
          <div class="fav-type">Quote</div>
          <div class="fav-text">"${r(n.data.content)}"</div>
          <div class="fav-sub">‚Äî ${r(n.data.author)}</div>
        </div>
        <button class="btn-fav-remove" aria-label="Remove from favorites">‚úï</button>
      `:a.innerHTML=`
        <div>
          <div class="fav-type">Track</div>
          <div class="fav-text">${r(n.data.title)}</div>
          <div class="fav-sub">${r(n.data.artist)}</div>
        </div>
        <button class="btn-fav-remove" aria-label="Remove from favorites">‚úï</button>
      `,a.querySelector(".btn-fav-remove").addEventListener("click",()=>{$(l),u(),E(),c("Removed from favorites")}),e.appendChild(a)})}function u(){const e=document.getElementById("favCount");e&&(e.textContent=C())}function r(e){return String(e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}let s=null;function R(){B(document.getElementById("moodGrid"),O),u(),document.getElementById("backBtn").addEventListener("click",f),document.getElementById("closeFavBtn").addEventListener("click",f),document.getElementById("favoritesBtn").addEventListener("click",J),document.getElementById("refreshQuoteBtn").addEventListener("click",()=>{s&&m(s)}),document.getElementById("retryQuoteBtn").addEventListener("click",()=>{s&&m(s)}),document.getElementById("retryMusicBtn").addEventListener("click",()=>{s&&w(s)})}function O(e){s=e,Q(e),y("resultsScreen"),m(e),w(e)}async function m(e){x();try{const t=await k(e.quoteTag);H(t)}catch{j()}}async function w(e){N();try{const t=await A(e.musicQuery);P(t)}catch{F()}}function f(){b();const e=document.getElementById("favoritesScreen").classList.contains("active");y(e&&s?"resultsScreen":"moodScreen")}function J(){b(),E(),y("favoritesScreen")}R();var g;(g=document.getElementById("darkModeToggle"))==null||g.addEventListener("click",()=>{document.body.classList.toggle("dark-mode");const e=document.body.classList.contains("dark-mode");localStorage.setItem("darkMode",e),showToast(e?"üåô Dark mode enabled":"‚òÄÔ∏è Light mode enabled")});localStorage.getItem("darkMode")==="true"&&document.body.classList.add("dark-mode");
