(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const m of o.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&i(m)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();const B=[{id:"happy",emoji:"ðŸ˜Š",label:"Happy",desc:"Joyful & bright",color:"#f5c842",quoteTag:"happiness",musicQuery:"happy upbeat pop"},{id:"calm",emoji:"ðŸŒ¿",label:"Calm",desc:"Peaceful & still",color:"#6db58e",quoteTag:"peace",musicQuery:"chill lofi ambient"},{id:"sad",emoji:"ðŸŒ§ï¸",label:"Sad",desc:"Heavy & tender",color:"#7da8d4",quoteTag:"inspirational",musicQuery:"sad emotional ballad"},{id:"anxious",emoji:"ðŸŒ€",label:"Anxious",desc:"Unsettled & tense",color:"#c4775a",quoteTag:"courage",musicQuery:"calming meditation relaxing"},{id:"motivated",emoji:"ðŸ”¥",label:"Motivated",desc:"Driven & focused",color:"#e07b39",quoteTag:"motivational",musicQuery:"motivational workout energy"},{id:"nostalgic",emoji:"ðŸ‚",label:"Nostalgic",desc:"Reflective & warm",color:"#c49a5a",quoteTag:"life",musicQuery:"nostalgic retro indie folk"},{id:"tired",emoji:"ðŸŒ™",label:"Tired",desc:"Weary & soft",color:"#9b8ac4",quoteTag:"rest",musicQuery:"sleep relaxing acoustic soft"},{id:"grateful",emoji:"ðŸŒ¸",label:"Grateful",desc:"Thankful & open",color:"#d47ba3",quoteTag:"gratitude",musicQuery:"grateful acoustic soulful"}];function I(e,t){e.innerHTML="",B.forEach(n=>{const i=document.createElement("button");i.className="mood-card",i.setAttribute("data-mood-id",n.id),i.setAttribute("aria-label",`Select mood: ${n.label}`),i.style.setProperty("--mood-color",n.color),i.innerHTML=`
      <span class="mood-emoji" aria-hidden="true">${n.emoji}</span>
      <span class="mood-label">${n.label}</span>
      <span class="mood-desc">${n.desc}</span>
    `,i.addEventListener("click",()=>{t(n)}),e.appendChild(i)})}const T="https://zenquotes.io/api/random",p={happiness:[{content:"Happiness is not something ready-made. It comes from your own actions.",author:"Dalai Lama"}],peace:[{content:"Do not let the behavior of others destroy your inner peace.",author:"Dalai Lama"}],inspirational:[{content:"Even the darkest night will end and the sun will rise.",author:"Victor Hugo"}],courage:[{content:"Breathe. It's just a bad day, not a bad life.",author:"Unknown"}],motivational:[{content:"The secret of getting ahead is getting started.",author:"Mark Twain"}],life:[{content:"In the end, it's not the years in your life that count. It's the life in your years.",author:"Abraham Lincoln"}],rest:[{content:"Almost everything will work again if you unplug it for a few minutes, including you.",author:"Anne Lamott"}],gratitude:[{content:"Gratitude turns what we have into enough.",author:"Melody Beattie"}]};async function S(e){try{const t=await fetch(T,{signal:AbortSignal.timeout(6e3)});if(!t.ok)throw new Error(`HTTP ${t.status}`);const n=await t.json();return{content:n[0].q,author:n[0].a}}catch(t){console.warn("Quotes API unavailable, using fallback:",t.message);const n=p[e]??p.inspirational;return n[Math.floor(Math.random()*n.length)]}}const q="https://itunes.apple.com/search",A=[{id:1,title:"Weightless",artist:"Marconi Union",album:"Weightless",cover:"",preview:"",duration:479},{id:2,title:"Clair de Lune",artist:"Claude Debussy",album:"Piano Works",cover:"",preview:"",duration:302},{id:3,title:"River Flows in You",artist:"Yiruma",album:"First Love",cover:"",preview:"",duration:214},{id:4,title:"Sunset Lover",artist:"Petit Biscuit",album:"Petit Biscuit",cover:"",preview:"",duration:213},{id:5,title:"Bloom",artist:"ODESZA",album:"Summer's Gone",cover:"",preview:"",duration:261}];async function C(e){var t;try{const n=`${q}?term=${encodeURIComponent(e)}&media=music&limit=5`,i=await fetch(n,{signal:AbortSignal.timeout(8e3)});if(!i.ok)throw new Error("HTTP ${res.status}");const a=await i.json();if(!((t=a.results)!=null&&t.length))throw new Error("No tracks found");return a.results.slice(0,5).map(o=>({id:o.trackId,title:o.trackName,artist:o.artistName,album:o.collectionName||"",cover:o.artworkUrl100||"",preview:o.previewUrl||"",duration:Math.floor(o.trackTimeMillis/1e3||0)}))}catch(n){return console.warn("Music API unavailable,using fallback:",n.message),A}}function M(e){return e?`${Math.floor(e/60)}:${String(e%60).padStart(2,"0")}`:""}const y="moodwave_favorites";function d(){try{return JSON.parse(localStorage.getItem(y))||[]}catch{return[]}}function E(e){const t=d();return t.some(i=>i.type===e.type&&JSON.stringify(i.data)===JSON.stringify(e.data))?!1:(t.unshift({...e,savedAt:Date.now()}),localStorage.setItem(y,JSON.stringify(t)),!0)}function $(e){const t=d();t.splice(e,1),localStorage.setItem(y,JSON.stringify(t))}function k(){return d().length}let f=null;function c(e,t=2800){const n=document.getElementById("toast");n&&(f&&clearTimeout(f),n.textContent=e,n.classList.add("show"),f=setTimeout(()=>n.classList.remove("show"),t))}function g(e){document.querySelectorAll(".screen").forEach(n=>n.classList.remove("active"));const t=document.getElementById(e);t&&(t.classList.add("active"),window.scrollTo({top:0,behavior:"smooth"}))}function Q(e){const t=document.getElementById("moodBadge");t&&(t.innerHTML=`<span aria-hidden="true">${e.emoji}</span> ${e.label}`,t.style.background=`${e.color}22`,t.style.color=e.color)}function x(){document.getElementById("quoteLoading").style.display="flex",document.getElementById("quoteContent").hidden=!0,document.getElementById("quoteError").hidden=!0}function N(e){document.getElementById("quoteLoading").style.display="none",document.getElementById("quoteError").hidden=!0,document.getElementById("quoteText").textContent=e.content,document.getElementById("quoteAuthor").textContent=e.author;const t=document.getElementById("saveQuoteBtn");t.textContent="â™¥ Save",t.classList.remove("saved"),t.onclick=()=>{E({type:"quote",data:e})?(t.textContent="â™¥ Saved!",t.classList.add("saved"),u(),c("Quote saved to favorites â™¥")):c("Already in your favorites!")},document.getElementById("quoteContent").hidden=!1}function P(){document.getElementById("quoteLoading").style.display="none",document.getElementById("quoteContent").hidden=!0,document.getElementById("quoteError").hidden=!1}let r=null;function H(){document.getElementById("musicLoading").style.display="flex",document.getElementById("tracksList").hidden=!0,document.getElementById("musicError").hidden=!0}function O(e){document.getElementById("musicLoading").style.display="none",document.getElementById("musicError").hidden=!0;const t=document.getElementById("tracksList");if(t.innerHTML="",!(e!=null&&e.length)){t.innerHTML='<p class="loading-state">No tracks found for this mood.</p>',t.hidden=!1;return}e.forEach(n=>{const i=document.createElement("div");i.className="track-item";const a=n.cover?`<img class="track-cover" src="${n.cover}" alt="${s(n.title)} cover" loading="lazy">`:'<div class="track-cover-placeholder" aria-hidden="true">â™ª</div>';i.innerHTML=`
      ${a}
      <div class="track-info">
        <div class="track-title">${s(n.title)}</div>
        <div class="track-artist">${s(n.artist)}${n.album?" Â· "+s(n.album):""}${n.duration?" Â· "+M(n.duration):""}</div>
      </div>
      <div class="track-actions">
        ${n.preview?`<button class="btn-play" aria-label="Play preview of ${s(n.title)}" title="Play 30s preview">â–¶</button>`:""}
        <button class="btn-track-save" aria-label="Save ${s(n.title)}" title="Save to favorites">â™¥</button>
      </div>
    `,n.preview&&i.querySelector(".btn-play").addEventListener("click",o=>F(n,o.currentTarget)),i.querySelector(".btn-track-save").addEventListener("click",o=>{E({type:"track",data:n})?(o.currentTarget.style.color="var(--accent)",u(),c(`"${n.title}" saved â™¥`)):c("Already in your favorites!")}),t.appendChild(i)}),t.hidden=!1}function F(e,t){r&&r.src!==e.preview&&(r.pause(),document.querySelectorAll(".btn-play").forEach(n=>n.textContent="â–¶")),(!r||r.src!==e.preview)&&(r=new Audio(e.preview),r.addEventListener("ended",()=>t.textContent="â–¶")),r.paused?(r.play().catch(()=>c("Could not play preview")),t.textContent="â¸"):(r.pause(),t.textContent="â–¶")}function b(){r&&(r.pause(),r=null,document.querySelectorAll(".btn-play").forEach(e=>e.textContent="â–¶"))}function j(){document.getElementById("musicLoading").style.display="none",document.getElementById("tracksList").hidden=!0,document.getElementById("musicError").hidden=!1}function w(){const e=document.getElementById("favoritesList"),t=document.getElementById("emptyFavorites"),n=d();if(e.innerHTML="",!n.length){t.hidden=!1;return}t.hidden=!0,n.forEach((i,a)=>{const o=document.createElement("div");o.className="fav-item",i.type==="quote"?o.innerHTML=`
        <div>
          <div class="fav-type">Quote</div>
          <div class="fav-text">"${s(i.data.content)}"</div>
          <div class="fav-sub">â€” ${s(i.data.author)}</div>
        </div>
        <button class="btn-fav-remove" aria-label="Remove from favorites">âœ•</button>
      `:o.innerHTML=`
        <div>
          <div class="fav-type">Track</div>
          <div class="fav-text">${s(i.data.title)}</div>
          <div class="fav-sub">${s(i.data.artist)}</div>
        </div>
        <button class="btn-fav-remove" aria-label="Remove from favorites">âœ•</button>
      `,o.querySelector(".btn-fav-remove").addEventListener("click",()=>{$(a),u(),w(),c("Removed from favorites")}),e.appendChild(o)})}function u(){const e=document.getElementById("favCount");e&&(e.textContent=k())}function s(e){return String(e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}let l=null;function D(){I(document.getElementById("moodGrid"),U),u(),document.getElementById("backBtn").addEventListener("click",h),document.getElementById("closeFavBtn").addEventListener("click",h),document.getElementById("favoritesBtn").addEventListener("click",_),document.getElementById("refreshQuoteBtn").addEventListener("click",()=>{l&&v(l)}),document.getElementById("retryQuoteBtn").addEventListener("click",()=>{l&&v(l)}),document.getElementById("retryMusicBtn").addEventListener("click",()=>{l&&L(l)})}function U(e){l=e,Q(e),g("resultsScreen"),v(e),L(e)}async function v(e){x();try{const t=await S(e.quoteTag);N(t)}catch{P()}}async function L(e){H();try{const t=await C(e.musicQuery);O(t)}catch{j()}}function h(){b();const e=document.getElementById("favoritesScreen").classList.contains("active");g(e&&l?"resultsScreen":"moodScreen")}function _(){b(),w(),g("favoritesScreen")}D();
