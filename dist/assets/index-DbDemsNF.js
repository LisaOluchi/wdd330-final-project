(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function o(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=o(a);fetch(a.href,i)}})();const B=[{id:"happy",emoji:"ðŸ˜Š",label:"Happy",desc:"Joyful & bright",color:"#f5c842",quoteTag:"happiness",musicQuery:"happy upbeat pop"},{id:"calm",emoji:"ðŸŒ¿",label:"Calm",desc:"Peaceful & still",color:"#6db58e",quoteTag:"peace",musicQuery:"chill lofi ambient"},{id:"sad",emoji:"ðŸŒ§ï¸",label:"Sad",desc:"Heavy & tender",color:"#7da8d4",quoteTag:"inspirational",musicQuery:"sad emotional ballad"},{id:"anxious",emoji:"ðŸŒ€",label:"Anxious",desc:"Unsettled & tense",color:"#c4775a",quoteTag:"courage",musicQuery:"calming meditation relaxing"},{id:"motivated",emoji:"ðŸ”¥",label:"Motivated",desc:"Driven & focused",color:"#e07b39",quoteTag:"motivational",musicQuery:"motivational workout energy"},{id:"nostalgic",emoji:"ðŸ‚",label:"Nostalgic",desc:"Reflective & warm",color:"#c49a5a",quoteTag:"life",musicQuery:"nostalgic retro indie folk"},{id:"tired",emoji:"ðŸŒ™",label:"Tired",desc:"Weary & soft",color:"#9b8ac4",quoteTag:"rest",musicQuery:"sleep relaxing acoustic soft"},{id:"grateful",emoji:"ðŸŒ¸",label:"Grateful",desc:"Thankful & open",color:"#d47ba3",quoteTag:"gratitude",musicQuery:"grateful acoustic soulful"}];function I(e,t){e.innerHTML="",B.forEach(o=>{const n=document.createElement("button");n.className="mood-card",n.setAttribute("data-mood-id",o.id),n.setAttribute("aria-label",`Select mood: ${o.label}`),n.style.setProperty("--mood-color",o.color),n.innerHTML=`
      <span class="mood-emoji" aria-hidden="true">${o.emoji}</span>
      <span class="mood-label">${o.label}</span>
      <span class="mood-desc">${o.desc}</span>
    `,n.addEventListener("click",()=>{t(o)}),e.appendChild(n)})}const T="https://api.quotable.io/random",p={happiness:[{content:"Happiness is not something ready made. It comes from your own actions.",author:"Dalai Lama"}],peace:[{content:"Peace begins with a smile.",author:"Mother Teresa"}],inspirational:[{content:"The only way to do great work is to love what you do.",author:"Steve Jobs"}],courage:[{content:"Courage is resistance to fear, mastery of fear, not absence of fear.",author:"Mark Twain"}],motivational:[{content:"The future belongs to those who believe in the beauty of their dreams.",author:"Eleanor Roosevelt"}],life:[{content:"In three words I can sum up everything I've learned about life: it goes on.",author:"Robert Frost"}],rest:[{content:"Rest and be thankful.",author:"William Wordsworth"}],gratitude:[{content:"Gratitude turns what we have into enough.",author:"Aesop"}]};async function S(e){try{const t=`${T}?tags=${encodeURIComponent(e)}&maxLength=180`,o=await fetch(t,{signal:AbortSignal.timeout(6e3)});if(!o.ok)throw new Error("HTTP ${res.status}");const n=await o.json();return{content:n.content,author:n.author}}catch(t){console.warn("Quote API unavailable, using fallback:",t.message);const o=p[e]??p.inspirational;return o[Math.floor(Math.random()*o.length)]}}const q="https://itunes.apple.com/search",C=[{id:1,title:"Weightless",artist:"Marconi Union",album:"Weightless",cover:"",preview:"",duration:479},{id:2,title:"Clair de Lune",artist:"Claude Debussy",album:"Piano Works",cover:"",preview:"",duration:302},{id:3,title:"River Flows in You",artist:"Yiruma",album:"First Love",cover:"",preview:"",duration:214},{id:4,title:"Sunset Lover",artist:"Petit Biscuit",album:"Petit Biscuit",cover:"",preview:"",duration:213},{id:5,title:"Bloom",artist:"ODESZA",album:"Summer's Gone",cover:"",preview:"",duration:261}];async function $(e){try{const t=`${q}?term=${encodeURIComponent(e)}&media=music&limit=5`,o=await fetch(t,{signal:AbortSignal.timeout(8e3)});if(!o.ok)throw new Error("HTTP ${res.status}");const n=await o.json();if(!n.results?.length)throw new Error("No tracks found");return n.results.slice(0,5).map(a=>({id:a.trackId,title:a.trackName,artist:a.artistName,album:a.collectionName||"",cover:a.artworkUrl100||"",preview:a.previewUrl||"",duration:Math.floor(a.trackTimeMillis/1e3||0)}))}catch(t){return console.warn("Music API unavailable,using fallback:",t.message),C}}function M(e){return e?`${Math.floor(e/60)}:${String(e%60).padStart(2,"0")}`:""}const y="moodwave_favorites";function d(){try{return JSON.parse(localStorage.getItem(y))||[]}catch{return[]}}function b(e){const t=d();return t.some(n=>n.type===e.type&&JSON.stringify(n.data)===JSON.stringify(e.data))?!1:(t.unshift({...e,savedAt:Date.now()}),localStorage.setItem(y,JSON.stringify(t)),!0)}function k(e){const t=d();t.splice(e,1),localStorage.setItem(y,JSON.stringify(t))}function A(){return d().length}let f=null;function l(e,t=2800){const o=document.getElementById("toast");o&&(f&&clearTimeout(f),o.textContent=e,o.classList.add("show"),f=setTimeout(()=>o.classList.remove("show"),t))}function g(e){document.querySelectorAll(".screen").forEach(o=>o.classList.remove("active"));const t=document.getElementById(e);t&&(t.classList.add("active"),window.scrollTo({top:0,behavior:"smooth"}))}function Q(e){const t=document.getElementById("moodBadge");t&&(t.innerHTML=`<span aria-hidden="true">${e.emoji}</span> ${e.label}`,t.style.background=`${e.color}22`,t.style.color=e.color)}function x(){document.getElementById("quoteLoading").style.display="flex",document.getElementById("quoteContent").hidden=!0,document.getElementById("quoteError").hidden=!0}function P(e){document.getElementById("quoteLoading").style.display="none",document.getElementById("quoteError").hidden=!0,document.getElementById("quoteText").textContent=e.content,document.getElementById("quoteAuthor").textContent=e.author;const t=document.getElementById("saveQuoteBtn");t.textContent="â™¥ Save",t.classList.remove("saved"),t.onclick=()=>{b({type:"quote",data:e})?(t.textContent="â™¥ Saved!",t.classList.add("saved"),u(),l("Quote saved to favorites â™¥")):l("Already in your favorites!")},document.getElementById("quoteContent").hidden=!1}function N(){document.getElementById("quoteLoading").style.display="none",document.getElementById("quoteContent").hidden=!0,document.getElementById("quoteError").hidden=!1}let r=null;function F(){document.getElementById("musicLoading").style.display="flex",document.getElementById("tracksList").hidden=!0,document.getElementById("musicError").hidden=!0}function H(e){document.getElementById("musicLoading").style.display="none",document.getElementById("musicError").hidden=!0;const t=document.getElementById("tracksList");if(t.innerHTML="",!e?.length){t.innerHTML='<p class="loading-state">No tracks found for this mood.</p>',t.hidden=!1;return}e.forEach(o=>{const n=document.createElement("div");n.className="track-item";const a=o.cover?`<img class="track-cover" src="${o.cover}" alt="${s(o.title)} cover" loading="lazy">`:'<div class="track-cover-placeholder" aria-hidden="true">â™ª</div>';n.innerHTML=`
      ${a}
      <div class="track-info">
        <div class="track-title">${s(o.title)}</div>
        <div class="track-artist">${s(o.artist)}${o.album?" Â· "+s(o.album):""}${o.duration?" Â· "+M(o.duration):""}</div>
      </div>
      <div class="track-actions">
        ${o.preview?`<button class="btn-play" aria-label="Play preview of ${s(o.title)}" title="Play 30s preview">â–¶</button>`:""}
        <button class="btn-track-save" aria-label="Save ${s(o.title)}" title="Save to favorites">â™¥</button>
      </div>
    `,o.preview&&n.querySelector(".btn-play").addEventListener("click",i=>O(o,i.currentTarget)),n.querySelector(".btn-track-save").addEventListener("click",i=>{b({type:"track",data:o})?(i.currentTarget.style.color="var(--accent)",u(),l(`"${o.title}" saved â™¥`)):l("Already in your favorites!")}),t.appendChild(n)}),t.hidden=!1}function O(e,t){r&&r.src!==e.preview&&(r.pause(),document.querySelectorAll(".btn-play").forEach(o=>o.textContent="â–¶")),(!r||r.src!==e.preview)&&(r=new Audio(e.preview),r.addEventListener("ended",()=>t.textContent="â–¶")),r.paused?(r.play().catch(()=>l("Could not play preview")),t.textContent="â¸"):(r.pause(),t.textContent="â–¶")}function E(){r&&(r.pause(),r=null,document.querySelectorAll(".btn-play").forEach(e=>e.textContent="â–¶"))}function j(){document.getElementById("musicLoading").style.display="none",document.getElementById("tracksList").hidden=!0,document.getElementById("musicError").hidden=!1}function w(){const e=document.getElementById("favoritesList"),t=document.getElementById("emptyFavorites"),o=d();if(e.innerHTML="",!o.length){t.hidden=!1;return}t.hidden=!0,o.forEach((n,a)=>{const i=document.createElement("div");i.className="fav-item",n.type==="quote"?i.innerHTML=`
        <div>
          <div class="fav-type">Quote</div>
          <div class="fav-text">"${s(n.data.content)}"</div>
          <div class="fav-sub">â€” ${s(n.data.author)}</div>
        </div>
        <button class="btn-fav-remove" aria-label="Remove from favorites">âœ•</button>
      `:i.innerHTML=`
        <div>
          <div class="fav-type">Track</div>
          <div class="fav-text">${s(n.data.title)}</div>
          <div class="fav-sub">${s(n.data.artist)}</div>
        </div>
        <button class="btn-fav-remove" aria-label="Remove from favorites">âœ•</button>
      `,i.querySelector(".btn-fav-remove").addEventListener("click",()=>{k(a),u(),w(),l("Removed from favorites")}),e.appendChild(i)})}function u(){const e=document.getElementById("favCount");e&&(e.textContent=A())}function s(e){return String(e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}let c=null;function R(){I(document.getElementById("moodGrid"),D),u(),document.getElementById("backBtn").addEventListener("click",h),document.getElementById("closeFavBtn").addEventListener("click",h),document.getElementById("favoritesBtn").addEventListener("click",_),document.getElementById("refreshQuoteBtn").addEventListener("click",()=>{c&&v(c)}),document.getElementById("retryQuoteBtn").addEventListener("click",()=>{c&&v(c)}),document.getElementById("retryMusicBtn").addEventListener("click",()=>{c&&L(c)})}function D(e){c=e,Q(e),g("resultsScreen"),v(e),L(e)}async function v(e){x();try{const t=await S(e.quoteTag);P(t)}catch{N()}}async function L(e){F();try{const t=await $(e.musicQuery);H(t)}catch{j()}}function h(){E();const e=document.getElementById("favoritesScreen").classList.contains("active");g(e&&c?"resultsScreen":"moodScreen")}function _(){E(),w(),g("favoritesScreen")}R();
